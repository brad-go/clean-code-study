# 1장 깨끗한 코드

날짜: 2022년 3월 16일
생성일: 2022년 3월 16일 오후 9:06

# 이 책을 통해서 얻을 수 있는 것

1. 코드에 대해 많은 사실을 배운다.
2. 좋은 코드와 나쁜 코드를 구분하는 능력을 얻는다.
3. 좋은 코드를 작성하는 방법도 익힌다.
4. 나쁜 코드를 좋은 코드로 바꾸는 실력도 쌓는다.

# 코드가 존재하리라

코드를 다루는 책이 시대에 뒤떨어졌다거나, 코드의 종말이 다가왔다고 주장도 여럿 존재한다. 코드는 더 이상 문제가 아니라, 모델이나 요구사항에 집중해야 한다고 주장하며 코드를 자동으로 생성하는 시대가 도래해 프로그래머가 필요없다고 주장하는 생각은 틀렸다.

- 기계가 실행할 정도로 상세하게 요구사항을 명시하는 작업이 프로그래밍이며, 그 결과가 코드이기 때문이다.
- 고도로 추상화된 언어나 특정 응용 분야 언어로 기술하는 명세 역시 코드이기 때문이다.

> 💡 **코드는 요구 사항을 상세히 표현하는 수단이자 언어이다.**

# 나쁜 코드

- Killer App 하나로 대박난 회사가 있었지만, 머지 않아 망했다. **원인은 나쁜 코드**였다.
- 나쁜 코드에 발목이 잡혀 고생하며 헤쳐나가는 것을 **고행(wading)**이라고 한다.
- 일정에 맞춰 나쁜 코드를 짜고 나중에 고치겠다고 생각한 경험이 있을 것이다. 안 돌아가는 프로그램보다 돌아가는 쓰레기가 좋다고 스스로 위로했던 것처럼 말이다. 하지만 **나중은 결코 오지 않는다(르블랑의 법칙)**.

> 💡 **나중은 결코 오지 않는다.**

# 나쁜 코드로 치르는 대가

초기에는 빠른 속도로 진행되던 프로젝트가 1-2년 만에 굼뱅이처럼 느린 페이스로 진행되는 것을 볼 수 있다. 매번 얽히고설킨 코드를 ‘해독'해내서 엃히고설킨 코드를 더해 고칠 때마다 엉뚱한 곳에서 문제가 생기기 때문에 청소할 방법을 찾지 못한다. 불가항력이다.

> 💡 **나쁜 코드로 짠 프로그램에 가해지는 변경사항에는 어느 것 하나 사소하지 않다.**

나쁜 코드가 쌓일수록 팀 생산성은 떨어진다. 그러다가 마침내 0에 근접한다. \*\*\*\*관리팀은 새 인력과 팀으로 재설계를 꿈꾸지만, 나쁜 코드를 더 많이 양산하고 생산성은 더더욱 떨어져 거의 0이 된다.

> 💡 **시간을 들여 깨끗한 코드를 만드는 노력이 비용을 절감하는 방법일 뿐만 아니라 전문가로서 살아남는 길이다.**

## 태도

몇시간 정도로 예상한 업무가 몇 주로 늘어지거나, 한 줄만 고치면 되리라 생각했다가 모듈을 수백 개 건드리게 되는 경우가 자주 있을 것이다. 코드가 왜 그렇게 되었을까? 우리 프로그래머가 전문가 답지 못했기 때문이다.

- 관리자와 마케팅이 약속과 공약을 내걸며 우리에게 정보를 구할 때, 혹은 구하지 않더라도 우리는 적극적으로 정보를 제공해야 마땅하다.
- 우리는 프로젝트를 계획하는 과정에 깊숙이 관여하므로 프로젝트의 실패는 우리에게도 큰 책임이 있다.
- 나쁜 코드의 위험을 이해하지 못하는 관리자 말을 그대로 따르는 행동은 전문가답지 못하다.

> 💡 **좋은 코드를 사수하는 일은 바로 우리 프로그래머들의 책임이다.**

## 원초의 난제

프로그래머들은 나쁜 코드가 업무 속도를 늦춘다는 사실을 이미 알고 있다. 그럼에도 모든 프로그래머가 기한을 맞추려면 나쁜 코드를 양산할 수 밖에 없다고 느낀다. 즉, 빨리 가려고 시간을 들이지 않는다. 나쁜 코드를 양산하면 결국 기한을 맞추지 못한다.

> 💡 **빨리 가기 위한 유일한 방법은, 언제나 코드를 깨끗하게 유지하는 습관이다.**

## 깨끗한 코드라는 예술?

나쁜 코드가 심각한 장애물이라는 것을 알았다면 궁금할 것이다. “깨끗한 코드는 어떻게 작성할까?” 깨끅한 코드를 구현하는 행위는 그림을 그리는 행위와 비슷하다. 그림을 잘 그렸는지, 못 그렸는지 구분하는 사람이 무조건 그림을 잘 그리지 않듯, 깨끗한 코드의 구분과 작성도 마찬가지이다.

깨끗한 코드를 작성하려면 ‘청결'이라는 힘겹게 습득한 감각을 활용해 자잘한 기법들을 적용하는 절제와 규율이 필요하다. 열쇠는 ‘**코드 감각**'이다. 코드 감각이 있다면

- 좋은 코드와 나쁜 코드를 구분한다.
- 절제와 규율을 적용해 나쁜 코드를 좋은 코드로 바꾸는 전략도 파악한다.
- ‘코드 감각'이 없는 프로그래머도 때로 나쁜 모듈을 알아본다. 하지만 ‘코드 감각'이 있는 프로그래머는 나쁜 모듈을 보면 좋은 모듈로 개선할 방안을 떠올린다.

💡 **깨끗한 코드를 작성하는 프로그래머는 빈 캔버스를 우아한 작품으로 바꿔가는 화가와 같다.**

## 깨끗한 코드란?

### Bjarne Stroustrup

_C++ 창시자이자 The C++ Programming Language저자_

- 깨끗한 코드는 ‘보기에 즐거운' 코드다. (**가독성**)
- 코드의 **효율**을 고려해야 한다. 효율을 고려하지 못한 우아하지 못한 나쁜 코드는 나쁜 코드를 유혹해 고치면서 나쁜 코드를 만들기 때문이다. ([깨진 창문](https://www.artima.com/articles/dont-live-with-broken-windows), [깨진 유리창 이론](https://ko.wikipedia.org/wiki/%EA%B9%A8%EC%A7%84_%EC%9C%A0%EB%A6%AC%EC%B0%BD_%EC%9D%B4%EB%A1%A0))
- 철저한 **오류 처리**, **메모리 누수**, **경쟁 상태**, 일관성 없는 **네이밍**도 신경써야 한다.
- 나쁜 코드는 너무 많은 일을 하려 애쓰다가 의도가 뒤섞이고 목적이 흐려진다. 깨끗한 코드는 한 가지에 ‘집중'한다. **깨끗한 코드는 한 가지를 잘 한다**.

### Grady Booch

_Object Oriented Analysis and Design with Application 저자_

- 깨끗한 코드는 잘 쓴 문장처럼 읽혀야 한다. (**가독성**)
  - 좋은 소설처럼 깨끗한 코드는 해결할 문제의 긴장을 명확히 드러내고, 명백한 해법을 제시하며 긴장과 문제를 풀어야 한다.
- 명쾌한 **추상화**
  - 코드는 추측이 아니라 사실에 기반해야 한다.
  - **반드시 필요한 내용만 담아야 한다**.

### Dava Thomas

_OTI 창립자이자 이클립스 전략의 대부_

- 깨끗한 코드는 다른 사람이 고치기 쉽다. (**가독성**)
  - 코드는 간결할 수록 좋다.
  - 코드는 문학적이어야 한다. (사람이 읽기 좋은 코드)
- 테스트 케이스가 없는 코드는 깨끗한 코드가 아니다.
  - 단위 테스트 케이스와 인수 테스트 케이스가 존재한다.

### Michael Feathers

_Working Effectively with Legacy Code 저자_

- 깨끗한 코드는 **주의** 깊게 작성한 코드다.

### Ron Jeffreis

_Extreme Programming Installed와 Extreme Programming Adeventure in C# 저자_

- **중복**을 피하라.
  - 같은 작업을 여러 차례 반복한다면 코드가 아이디어를 제대로 표현하지 못한다는 증거다.
- 제대로 **표현**하라.
  - 의미 있는 이름을 사용한다.
- **한 기능만 수행**하라.
  - 함수, 객체, 메서드 등이 하는 일을 명확히 나눠 한가지 일만 하게 한다.
- 작게 **추상화**하라.
  - 프로젝트 시작부터 추상화를 고려해서 개발을 원활히 진행할 수 있도록 한다.

### Ward Cunningham

_위키 창시자, 피트 창시자, 익스트림 프로그래밍 공동 창시자 등_

- 읽으면서 짐작한 대로 돌아가는 코드가 깨끗한 코드다.
- 코드를 단순하게 보이도록 만드는 책임은 프로그래머에게 있다.

# 우리들 생각

이 책은 저자와 동료들이 생각하는 바를 끔찍할 정도로 상세히 설명한다. 깨끗한 변수 이름, 깨끗한 함수, 깨끗한 클래스를 만드는 방법을 소개한다. 모든 무술가들이 동의하는 ‘최고의 무술'이나 ‘최고의 기술'이 없듯이 깨끗한 코드를 작성하는 방법도 마찬가지이다.

이 책에서 말하는 방법이 절대로 ‘옳다’라고 단정은 금물이다. 여러 집단과 전문가가 존재하며 그들에게 배움을 얻는 것이 좋다. 실제로 이 책에서 주장하는 기법 다수는 논재의 여지가 있다. 모두가 동의하지 않을 것이고, 반대할 수도 있다. 하지만 중요한 것은 **오랫동안 고민하고 숙고한 기법이고, 반복적인 시행착오로 습득한 교훈과 기법이므로 최대한 저자와 동료들의 시각을 이해하고 존중하려 애써보자**.

# 우리는 작가다

우리는 작가다. 작가에게는 독자가 있다. 그리고 작가에게는 독자와 잘 소통할 책임도 있다. **다음에 코드를 짤 때는 자신이 작가라는 사실을, 우리들의 노력을 보고 판단을 내릴 독자가 있다는 사실을 기억하자**.

어쩌면 당신은 코드를 읽는 시간보다 작성하는 데에 더 많은 시간이 필요하다고 생각할지도 모른다. 하지만 실상은 그 반대다.

과거 저자의 편집기(이 편집기는 사용자가 입력한 모든 키를 기억했다.)를 통해 편집 세션을 재생해보면 대부분이 화면을 스크롤하거나 다른 모듈을 찾아보는 동작이었다. 코드를 읽는 시간 대 코드를 짜는 시간 비율이 10대 1을 훌쩍 넘는다. **새 코드를 짜면서 우리는 끊임없이 기존 코드를 읽는다.**

**주변 코드를 읽지 않으면 새 코드를 짜지 못한다**. 주변 코드를 읽기 쉬우면 새 코드를 짜기도 쉽다. 그러므로 읽기 쉬운 코드를 짜기가 쉽지 않더라도, **서둘러 끝내고, 빨리 짜려면 읽기 쉽게 만들면 된다.**

# 보이스카우트 규칙

잘 짠 코드가 전부는 아니다. **시간이 지나도 언제나 깨끗하게 유지해야 한다.** 미국 보이스카우트가 따르는 간단한 규칙이 우리에게 유용할 수 있다.

> **캠프장은 처음 왔을 때보다 더 깨끗하게 해놓고 떠나라.**

코드를 작성할 때마다 조금 더 깨끗한 코드를 작성한다면 코드는 절대 나빠지지 않는다. 한꺼번에 많은 시간과 노력을 투자해 코드를 정리할 필요가 없다. 변수 이름 하나를 개선하고, 조금 긴 함수 하나를 분할하고, 약간의 중복을 제거하고, 복잡한 if 문 하나를 정리하면 충분하다.

<aside>
💡 **지속적인 개선이야말로 전문가 정신의 본질이다.**

</aside>

# 정리

이 책을 읽는다고 뛰어난 프로그래머가 된다는 보장은 없다. ‘코드 감각'을 확실히 얻는다는 보장도 없다. 단지 뛰어난 프로그래머가 생각하는 방식과 그들이 사용하는 기술과 기교와 도구를 소개할 뿐이다.

예술 책들과 마찬가지로 이 책은 좋은 코드와 나쁜 코드를 소개할 것이다. 나쁜 코드를 좋은 코드로 바꾸는 방법도 소개한다. 다양한 경험적 교훈과 체계와 절차와 기법도 열거한다. 예제도 무수히 많이 보여준다. **나머지는 여러분에게 달렸다**.

공연으로 가다가 길을 잃은 연주회의 바이올리니스트에 대한 우스갯소리를 아는가? 그는 길거리에서 한 노인게게 카네기 홀로 가는 방법을 물었다. 노인은 연주자와 그가 든 바이올린을 보고 이렇게 말했다.

> **“연습해, 연습!”**

# 퀴즈

### 1. 코드가 존재하리라

저자가 말한 코드가 절대 사라지지 않는 이유가 있다. 무엇일까?

<details><summary><b>정답</b></summary><div markdown="1">

코드는 요구 사항을 상세히 표현하는 수단이니까! 어느 수준에 이르면 코드의 도움없이 요구사항을 상세하게 표현하기란 불가능하기 때문

</div></details>

### 2. 깨끗한 코드

론 제프리스가 말한 것을 토대로 작가가 이 책을 요약했다고 했다. 그가 말한 깨끗한 코드를 작성하는 방법은 무엇일까?

1. \_\_ 을 피하라.
2. \_ 기능만 수행하라.
3. 제대로 \_\_ 하라.
4. 작게 \_\_\_하라.

<details><summary><b>정답</b></summary><div markdown="1">

중복, 한, 표현, 추상화

</div></details>
